<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Danh Sách Gói Vay Tốt Nhất | VayNhanh24h</title>
    <meta name="robots" content="noindex, nofollow">
    
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root { --primary: #FFB703; --blue: #023047; --text: #333; --bg: #f3f6fa; }
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family: 'Be Vietnam Pro', sans-serif; background: var(--bg); color: var(--text); padding-bottom: 50px; }
        .container { max-width: 800px; margin: 0 auto; padding: 0 15px; }

        /* HEADER */
        .header { background: #fff; padding: 15px 0; box-shadow: 0 2px 5px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 99; }
        .head-wrap { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-weight: 900; color: var(--blue); font-size: 18px; text-decoration: none; display: flex; align-items: center; gap: 5px; }
        .btn-back { font-size: 14px; font-weight: 600; color: #666; text-decoration: none; display: flex; align-items: center; gap: 5px; }

        /* FILTER BAR */
        .filter-bar { display: flex; gap: 10px; overflow-x: auto; padding: 20px 0; scrollbar-width: none; }
        .tag { white-space: nowrap; background: #fff; padding: 8px 15px; border-radius: 20px; font-size: 13px; font-weight: 600; color: #666; border: 1px solid #ddd; }
        .tag.active { background: var(--blue); color: #fff; border-color: var(--blue); }

        /* OFFERS */
        .offers-list { display: flex; flex-direction: column; gap: 20px; }
        
        .card { background: #fff; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.03); border: 1px solid #fff; position: relative; }
        .badge { position: absolute; top: 0; right: 0; background: #dcfce7; color: #16a34a; font-size: 10px; font-weight: 700; padding: 5px 10px; border-radius: 0 0 0 10px; text-transform: uppercase; }
        
        .card-main { display: flex; padding: 20px; align-items: center; gap: 15px; }
        .c-logo { width: 80px; height: 80px; object-fit: contain; flex-shrink: 0; border: 1px solid #eee; border-radius: 10px; padding: 5px; }
        .c-content { flex: 1; }
        .c-name { font-weight: 800; font-size: 16px; margin-bottom: 5px; color: var(--blue); }
        .c-desc { font-size: 12px; color: #666; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        
        .c-info { display: flex; border-top: 1px dashed #eee; padding: 15px 20px; justify-content: space-between; background: #fafafa; }
        .info-col { text-align: center; }
        .info-col span { display: block; font-size: 11px; color: #999; margin-bottom: 2px; }
        .info-col strong { display: block; font-size: 14px; color: #333; font-weight: 700; }

        .c-action { padding: 0 20px 20px; }
        .btn-apply { display: flex; justify-content: center; align-items: center; width: 100%; padding: 12px; background: var(--blue); color: #fff; font-weight: 700; border-radius: 10px; text-decoration: none; font-size: 15px; }
        .btn-disabled { background: #eee; color: #aaa; pointer-events: none; }

        /* HELPER */
        #helper { background: #333; color: #0f0; padding: 15px; border-radius: 10px; margin-bottom: 20px; display: none; font-family: monospace; font-size: 12px; }
        #helper textarea { width: 100%; background: #000; color: #fff; border: none; padding: 5px; }

        @media(max-width: 400px) {
            .card-main { flex-direction: column; text-align: center; }
            .c-logo { width: 60px; height: 60px; }
        }
    </style>
</head>
<body>

    <header class="header">
        <div class="container head-wrap">
            <a href="index.html" class="logo"><i class="fa-solid fa-coins"></i> VAYNHANH24H</a>
            <a href="index.html" class="btn-back"><i class="fa-solid fa-chevron-left"></i> Trở về</a>
        </div>
    </header>

    <div class="container">
        <div class="filter-bar">
            <div class="tag active">Tất cả</div>
            <div class="tag">Lãi suất 0%</div>
            <div class="tag">Duyệt nhanh</div>
            <div class="tag">Nợ xấu</div>
            <div class="tag">Hạn mức cao</div>
        </div>

        <div id="helper">
            <p>COPY VÀO LINKS.JSON:</p>
            <textarea id="h-txt"></textarea>
        </div>

        <div id="list" class="offers-list">
            <div style="text-align:center; padding: 50px;">
                <i class="fa-solid fa-circle-notch fa-spin" style="color:var(--blue); font-size:24px;"></i>
                <p style="font-size:12px; color:#999; margin-top:10px;">Đang tìm kiếm gói vay tốt nhất...</p>
            </div>
        </div>
        
        <p style="text-align:center; font-size:12px; color:#999; margin-top:30px;">Hệ thống tự động cập nhật sau mỗi 15 phút.</p>
    </div>

    <script>
        const PUB_ID = "28janns";
        const TOKEN = "hpoRHLinw3JgcQaV6g6SaQ=="; 
        const TEST_MODE = true; // Sửa thành false khi chạy thật
        const API = `https://publisher-api.riofintech.net/offer/all?pub_id=${PUB_ID}&token=${encodeURIComponent(TOKEN)}`;

        function track(key) {
            if(TEST_MODE) return;
            let h = JSON.parse(localStorage.getItem('vn24h_history') || '[]');
            if(!h.includes(key)) { h.push(key); localStorage.setItem('vn24h_history', JSON.stringify(h)); }
        }

        function getMeta(name) {
            let n = name.toLowerCase();
            if(n.includes('doctor')) return { l:'10 Triệu', r:'0% Lần đầu', t:'30 Ngày', d:'Duyệt tự động, không gọi thẩm định.' };
            if(n.includes('moneycat')) return { l:'15 Triệu', r:'0% Phí', t:'180 Ngày', d:'Ưu đãi 0% lãi suất cho khách hàng mới.' };
            if(n.includes('takomo')) return { l:'10 Triệu', r:'Duyệt nhanh', t:'90 Ngày', d:'Giải ngân siêu tốc trong 10 phút.' };
            if(n.includes('vayvnd')) return { l:'15 Triệu', r:'0% Lãi', t:'30 Ngày', d:'Thủ tục đơn giản chỉ cần CMND/CCCD.' };
            if(n.includes('f88')) return { l:'50 Triệu', r:'Cầm đồ', t:'12 Tháng', d:'Vay bằng đăng ký xe máy/ô tô.' };
            return { l:'20 Triệu', r:'Ưu đãi tốt', t:'Linh hoạt', d:'Khoản vay phù hợp với mọi nhu cầu.' };
        }

        function clean(name) {
            return name.replace(/\(.*\)/g, '').replace(/(VN|CP|CPL|CPS|CPI|Android|iOS|Web|App|APK)/gi, '').trim();
        }

        function getKey(name) { return name.toLowerCase().split(/[\s\-\.]+/)[0]; }

        async function run() {
            try {
                const [res1, res2] = await Promise.all([fetch(API), fetch('links.json').catch(()=>null)]);
                const data = await res1.json();
                const links = res2 && res2.ok ? await res2.json() : {};
                
                if(!links || Object.keys(links).length === 0) document.getElementById('helper').style.display='block';
                if(document.getElementById('helper').style.display === 'block') {
                    let t = "{\n" + data.data.map((o,i)=>`  "${o.name}": ""` + (i<data.data.length-1?",":"")).join("\n") + "\n}";
                    document.getElementById('h-txt').value = t;
                }

                const list = document.getElementById('list');
                const history = JSON.parse(localStorage.getItem('vn24h_history') || '[]');
                
                let html = '';
                let count = 0;

                data.data.forEach(item => {
                    const key = getKey(item.name);
                    if(!TEST_MODE && history.includes(key)) return;

                    let url = null;
                    for(const [k, v] of Object.entries(links)) {
                        if(v && v.length > 5 && item.name.toLowerCase().includes(k.toLowerCase())) url = v;
                    }

                    // Logic hiển thị: Nếu có link thì hiện, không có thì hiện mờ (hoặc ẩn luôn tùy đại ca)
                    // Ở đây em để hiện tất cả, cái nào ko có link thì disable
                    const hasLink = !!url;
                    if(!hasLink && !TEST_MODE) return; // Nếu chạy thật mà ko có link thì ẩn luôn cho đẹp

                    const meta = getMeta(item.name);
                    const name = clean(item.name);
                    
                    html += `
                    <div class="card ${hasLink ? '' : 'disabled'}">
                        ${hasLink ? '<div class="badge">Đề xuất</div>' : ''}
                        <div class="card-main">
                            <img src="${item.avatar}" class="c-logo" onerror="this.style.display='none'">
                            <div class="c-content">
                                <div class="c-name">${name}</div>
                                <div class="c-desc">${meta.d}</div>
                            </div>
                        </div>
                        <div class="c-info">
                            <div class="info-col"><span>Hạn mức</span><strong>${meta.l}</strong></div>
                            <div class="info-col"><span>Lãi suất</span><strong style="color:#eab308">${meta.r}</strong></div>
                            <div class="info-col"><span>Thời hạn</span><strong>${meta.t}</strong></div>
                        </div>
                        <div class="c-action">
                            <a href="${hasLink ? url : '#'}" target="${hasLink ? '_blank' : '_self'}" 
                               class="${hasLink ? 'btn-apply' : 'btn-apply btn-disabled'}"
                               onclick="track('${key}')">
                               ${hasLink ? 'ĐĂNG KÝ VAY NGAY' : 'TẠM HẾT HẠN MỨC'}
                            </a>
                        </div>
                    </div>`;
                    count++;
                });

                if(count === 0) list.innerHTML = '<p style="text-align:center">Bạn đã đăng ký hết các gói vay. Vui lòng quay lại sau.</p>';
                else list.innerHTML = html;

            } catch(e) {
                console.log(e);
                document.getElementById('list').innerHTML = '<p style="text-align:center;color:red">Lỗi tải dữ liệu.</p>';
            }
        }
        run();
    </script>

</body>
</html>

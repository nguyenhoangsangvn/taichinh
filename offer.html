<!DOCTYPE html>
<html lang="vi" class="loading-site no-js">
<head>
	<meta charset="UTF-8">
	<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Danh sách khoản vay - CatCredit</title>
	<meta name="robots" content="noindex, nofollow">

	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
	<link rel="stylesheet" id="flatsome-main-css" href="css/flatsome.css" type="text/css" media="all">
	<link rel="stylesheet" id="flatsome-style-css" href="css/style.css" type="text/css" media="all">
    <link rel="icon" href="images/cropped-catcredit-icon-32x32.png" sizes="32x32">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        body { font-family: 'Roboto', sans-serif; background-color: #f5f7fa; color: #333; }
        
        .page-header-simple { background: #fff; padding: 30px 0; border-bottom: 1px solid #eaeaea; text-align: center; margin-bottom: 30px; }
        .page-header-simple h1 { font-size: 24px; font-weight: 800; color: #333; margin: 0; }

        .offers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); /* Card to hơn xíu */
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto 50px;
            padding: 0 15px;
        }

        .loan-box {
            background: #fff; border-radius: 12px; border: 1px solid #e5e7eb; overflow: hidden; position: relative;
            transition: all 0.3s ease; display: flex; flex-direction: column;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        }
        .loan-box:hover { box-shadow: 0 15px 30px rgba(0,0,0,0.08); transform: translateY(-5px); border-color: #fec629; }

        .top-badge {
            position: absolute; top: 0; right: 0; background: #e8f5e9;
            color: #27ae60; font-size: 10px; font-weight: 700; padding: 5px 12px; 
            border-bottom-left-radius: 12px; z-index: 2; text-transform: uppercase;
        }

        /* Phần Logo */
        .box-header { padding: 20px; text-align: center; border-bottom: 1px dashed #eee; height: 90px; display: flex; align-items: center; justify-content: center; }
        .partner-logo { max-height: 45px; max-width: 70%; object-fit: contain; }

        /* Phần 3 thông số quan trọng */
        .box-body { padding: 15px 20px; flex-grow: 1; }
        
        .info-grid {
            display: flex;
            justify-content: space-between;
            text-align: center;
        }
        .info-item { width: 33%; border-right: 1px solid #f0f0f0; }
        .info-item:last-child { border-right: none; }
        
        .info-label { font-size: 11px; color: #888; display: block; margin-bottom: 4px; }
        .info-value { font-size: 14px; font-weight: 700; color: #111; display: block; }
        .info-value.highlight { color: #d26e4b; font-size: 15px; }

        /* Nút bấm */
        .box-footer { padding: 15px 20px 20px; text-align: center; }
        .btn-loan-action {
            display: block; width: 100%; background: #fec629; color: #000; padding: 12px; border-radius: 50px;
            font-weight: 700; font-size: 14px; text-transform: uppercase; text-decoration: none; transition: 0.2s;
            box-shadow: 0 4px 10px rgba(254, 198, 41, 0.3);
        }
        .btn-loan-action:hover { background: #eeb928; transform: scale(1.02); }

        .loading-spinner { text-align: center; padding: 50px; grid-column: 1 / -1; }
        .spinner { border: 4px solid #f3f3f3; border-top: 4px solid #fec629; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        @media(max-width: 600px) {
            .offers-grid { grid-template-columns: 1fr; }
            .info-grid { flex-wrap: wrap; }
            .info-item { width: 33%; margin-bottom: 0; }
        }
    </style>
</head>

<body class="page-template-default page page-id-99 wp-theme-flatsome wp-child-theme-vaymeo lightbox nav-dropdown-has-arrow">

<div id="wrapper">
	<header id="header" class="header">
		<div class="header-wrapper">
			<div id="masthead" class="header-main hide-for-sticky">
				<div class="header-inner flex-row container logo-left medium-logo-left" role="navigation">
					<div id="logo" class="flex-col logo">
						<a href="index.html" title="CatCredit" rel="home">
							<img width="300" height="205" src="images/catcredit-logo.png" class="header_logo header-logo" alt="CatCredit">
						</a>
					</div>
                    <div class="flex-col hide-for-medium flex-right">
                        <ul class="header-nav header-nav-main nav nav-right nav-size-large nav-spacing-xlarge">
                            <li><a href="index.html" class="nav-top-link"><i class="fa-solid fa-arrow-left"></i> Trang chủ</a></li>
                        </ul>
                    </div>
				</div>
			</div>
		</div>
	</header>

	<main id="main">
        <div class="page-header-simple">
            <div class="container">
                <h1>Đề xuất khoản vay phù hợp</h1>
            </div>
        </div>

        <div class="offers-grid" id="api-offers-container">
            <div class="loading-spinner">
                <div class="spinner"></div>
                <p>Đang tìm kiếm ưu đãi...</p>
            </div>
        </div>
	</main>

	<footer id="footer" class="footer-wrapper">
		<section class="section pb-0" style="background-color: #fff; padding-top:30px;">
			<div class="section-content relative">
				<div class="row row-small align-middle">
					<div class="col pb-0 medium-12 small-12 large-12">
						<div class="col-inner text-center">
                            <p>Bản quyền © CatCredit.vn (Local Version)</p>
						</div>
					</div>
				</div>
			</div>
		</section>
	</footer>
</div>

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/flatsome.js"></script>

<script>
    const PUB_ID = "28janns";
    const TOKEN = "hpoRHLinw3JgcQaV6g6SaQ=="; 
    const ENCODED_TOKEN = encodeURIComponent(TOKEN); 
    const API_URL = `https://publisher-api.riofintech.net/offer/all?pub_id=${PUB_ID}&token=${ENCODED_TOKEN}`;

    // --- HÀM THÔNG MINH: Tự điền thông tin nếu API không có ---
    function getSmartDetails(offerName) {
        let name = offerName.toLowerCase();
        
        // Mặc định (Nếu không nhận diện được tên)
        let details = {
            limit: '1 - 10 Triệu',
            interest: 'Ưu đãi tốt',
            term: 'Linh hoạt'
        };

        // Logic nhận diện (Ní có thể thêm các đối tác khác vào đây)
        if(name.includes('doctor')) {
            details = { limit: '500k - 10 Triệu', interest: '0% lần đầu', term: '10 - 30 ngày' };
        } else if (name.includes('moneycat') || name.includes('tamo') || name.includes('senmo')) {
            details = { limit: '1 - 15 Triệu', interest: '0% lãi & phí', term: '7 - 30 ngày' };
        } else if (name.includes('takomo') || name.includes('oncredit')) {
            details = { limit: '500k - 10 Triệu', interest: 'Duyệt nhanh', term: 'Linh hoạt' };
        } else if (name.includes('robocash')) {
            details = { limit: '1 - 10 Triệu', interest: 'Miễn phí 7 ngày', term: '3 - 6 tháng' };
        } else if (name.includes('jeff') || name.includes('crezu')) {
            details = { limit: 'Đến 20 Triệu', interest: 'So sánh vay', term: '3 - 12 tháng' };
        } else if (name.includes('vietmoney') || name.includes('f88')) {
            details = { limit: 'Đến 50 Triệu', interest: 'Cầm đồ', term: 'Đến 12 tháng' };
        } else if (name.includes('mafc') || name.includes('mcredit') || name.includes('fe')) {
            details = { limit: '10 - 70 Triệu', interest: '1.66%/tháng', term: '12 - 36 tháng' };
        } else if (name.includes('shinhan') || name.includes('vpbank')) {
             details = { limit: 'Đến 100 Triệu', interest: 'Thấp nhất', term: '1 - 4 năm' };
        }

        return details;
    }

    async function fetchOffers() {
        const container = document.getElementById('api-offers-container');
        try {
            const response = await fetch(API_URL);
            if (!response.ok) throw new Error('Err');
            const result = await response.json();
            container.innerHTML = '';

            if (result.status === 1 && result.data && result.data.length > 0) {
                result.data.forEach(offer => {
                    // Lấy link
                    let trackingLink = offer.tracking_link || offer.domain || '#';
                    if(trackingLink !== '#' && !trackingLink.startsWith('http')){ trackingLink = 'https://' + trackingLink; }

                    // Lấy thông tin thông minh
                    const smartInfo = getSmartDetails(offer.name);
                    
                    // Xử lý loại hình (Product Type)
                    let pType = offer.product_type || "Vay online";
                    if(pType === "undefined") pType = "Tài chính";

                    const cardHTML = `
                        <div class="loan-box">
                            <div class="top-badge">${pType}</div>
                            <div class="box-header">
                                <img src="${offer.avatar}" class="partner-logo" alt="${offer.name}" onerror="this.src='images/catcredit-logo.png'">
                            </div>
                            
                            <div class="box-body">
                                <div class="info-grid">
                                    <div class="info-item">
                                        <span class="info-label">Hạn mức</span>
                                        <span class="info-value highlight">${smartInfo.limit}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Lãi suất</span>
                                        <span class="info-value">${smartInfo.interest}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Thời hạn</span>
                                        <span class="info-value">${smartInfo.term}</span>
                                    </div>
                                </div>
                            </div>

                            <div class="box-footer">
                                <a href="${trackingLink}" target="_blank" class="btn-loan-action">
                                    Đăng ký ngay <i class="fa-solid fa-angle-right"></i>
                                </a>
                            </div>
                        </div>
                    `;
                    container.innerHTML += cardHTML;
                });
            } else {
                container.innerHTML = '<p style="text-align:center; width:100%">Chưa có ưu đãi nào.</p>';
            }
        } catch (error) {
            console.error(error);
            container.innerHTML = '<p style="text-align:center; color:red; width:100%">Lỗi tải dữ liệu. Vui lòng thử lại sau.</p>';
            // Fallback data demo nếu lỗi
            const demoInfo = getSmartDetails("DoctorDong");
             container.innerHTML += `
                <div class="loan-box">
                    <div class="top-badge">Demo</div>
                    <div class="box-header"><img src="images/catcredit-logo.png" class="partner-logo"></div>
                    <div class="box-body">
                        <div class="info-grid">
                            <div class="info-item"><span class="info-label">Hạn mức</span><span class="info-value highlight">${demoInfo.limit}</span></div>
                            <div class="info-item"><span class="info-label">Lãi suất</span><span class="info-value">${demoInfo.interest}</span></div>
                            <div class="info-item"><span class="info-label">Thời hạn</span><span class="info-value">${demoInfo.term}</span></div>
                        </div>
                    </div>
                    <div class="box-footer"><a href="#" class="btn-loan-action">Đăng ký ngay</a></div>
                </div>`;
        }
    }
    document.addEventListener('DOMContentLoaded', fetchOffers);
</script>

</body>
</html>
